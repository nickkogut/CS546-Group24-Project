<main>
  <h1>Compare Payroll Job Salaries</h1>

  {{#if error}}
    <p style="color:red">{{error}}</p>
  {{/if}}

  <!-- ==========================
       GRAPH SECTION
       ========================== -->
  <section id="graph-section" style="margin-bottom:30px;">
    <h2>Graph salaries for a job</h2>

    <div style="margin-bottom:8px;">
      <label for="jobSelect">Job title:</label>
      <select id="jobSelect">
        {{#each jobs}}
          <option value="{{this}}">{{this}}</option>
        {{/each}}
      </select>
    </div>

    <div style="margin-bottom:8px;">
      <label for="salaryInput">Your salary (optional):</label>
      <input id="salaryInput" type="number" placeholder="e.g. 60000" />
    </div>

    <div style="margin-bottom:8px;">
      <label for="chartType">Graph type:</label>
      <select id="chartType">
        <option value="histogram">Histogram</option>
        <option value="boxplot">Box & Whisker</option>
        <option value="dotplot">Dot Plot</option>
      </select>
    </div>

    <!-- FIXED: Agency, Borough, Year dropdown filters -->
    <div style="margin-bottom:8px;">
      <label for="filterAgency">Agency (optional):</label>
      <select id="filterAgency">
        <option value="">Any</option>
        {{#each agencies}}
          <option value="{{this}}">{{this}}</option>
        {{/each}}
      </select>

      <label for="filterBorough">Borough (optional):</label>
      <select id="filterBorough">
        <option value="">Any</option>
        {{#each boroughs}}
          <option value="{{this}}">{{this}}</option>
        {{/each}}
      </select>
    </div>

    <div style="margin-bottom:8px;">
      <label for="filterMinSalary">Min salary (optional):</label>
      <input id="filterMinSalary" type="number" placeholder="e.g. 30000" />
    </div>

    <div style="margin-bottom:8px;">
      <button id="compareBtn">Generate Graph</button>
    </div>

    <p id="status" style="color:red;"></p>

    <canvas id="histChart" width="800" height="400" style="background:#f6fbff;"></canvas>
    <div id="listingLink" style="margin-top:8px;"></div>
  </section>

  <hr>

  <!-- ==========================
       JOB STATS + TRANSITIONS
       ========================== -->
  <section id="job-stats" style="margin-bottom:30px;">
    <h2>Job Stats â€“ where do people in your role move on to?</h2>

    <div>
      <label for="fromJobInput">Your current job:</label>
      <select id="fromJobInput">
        {{#each jobs}}
          <option value="{{this}}">{{this}}</option>
        {{/each}}
      </select>
      <button id="findTransitionsBtn">Find transitions</button>
    </div>

    <p id="transitionsStatus" style="color:darkred;"></p>
    <div id="transitionsList" style="margin-top:10px;"></div>

    <div style="margin-top:10px;">
      <button id="compareSelectedBtn">Compare Selected Jobs</button>
    </div>

    <div id="compareResults" style="margin-top:10px;"></div>

    <hr style="margin:20px 0;">

    <!-- ==========================
         ADVANCED JOB LIST
         ========================== -->
    <h3>Advanced job list</h3>

    <div style="margin-bottom:8px;">
      <label for="advAgency">Agency:</label>
      <select id="advAgency">
        <option value="">Any</option>
        {{#each agencies}}
          <option value="{{this}}">{{this}}</option>
        {{/each}}
      </select>

      <label for="advBorough">Borough:</label>
      <select id="advBorough">
        <option value="">Any</option>
        {{#each boroughs}}
          <option value="{{this}}">{{this}}</option>
        {{/each}}
      </select>
    </div>

    <div style="margin-bottom:8px;">
      <label for="advYearFrom">Year from:</label>
      <select id="advYearFrom">
        <option value="">Any</option>
        {{#each years}}
          <option value="{{this}}">{{this}}</option>
        {{/each}}
      </select>

      <label for="advYearTo">Year to:</label>
      <select id="advYearTo">
        <option value="">Any</option>
        {{#each years}}
          <option value="{{this}}">{{this}}</option>
        {{/each}}
      </select>
    </div>

    <div style="margin-bottom:8px;">
      <label for="advMinAvg">Min avg salary:</label>
      <input id="advMinAvg" type="number" placeholder="e.g. 50000" />

      <label for="advMinCount">Min job entries:</label>
      <input id="advMinCount" type="number" placeholder="e.g. 5" />
    </div>

    <div style="margin-bottom:8px;">
      <button id="advancedJobsBtn">Show jobs</button>
    </div>

    <p id="advancedJobsStatus" style="color:darkred;"></p>
    <div id="advancedJobsResults" style="margin-top:10px;"></div>

    <hr style="margin:20px 0;">

    <!-- ==========================
         EXPERIENCE STATS
         ========================== -->
    <h3>Experience-based salary stats</h3>

    <div style="margin-bottom:8px;">
      <label for="expJobSelect">Job title:</label>
      <select id="expJobSelect">
        {{#each jobs}}
          <option value="{{this}}">{{this}}</option>
        {{/each}}
      </select>
    </div>

    <div style="margin-bottom:8px;">
      <label for="expMinYears">Min years in role:</label>
      <input id="expMinYears" type="number" placeholder="e.g. 5" />

      <label for="expMaxYears">Max years in role:</label>
      <input id="expMaxYears" type="number" placeholder="e.g. 10" />
    </div>

    <div style="margin-bottom:8px;">
      <button id="expStatsBtn">Show experience stats</button>
    </div>

    <p id="expStatus" style="color:darkred;"></p>
    <div id="experienceResults" style="margin-top:10px;"></div>

  </section>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="/js/compare.js"></script>
</main>
